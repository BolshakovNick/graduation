2021-01-16 13:08:47.509 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:08:47.516 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 16504 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:08:47.517 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:08:48.305 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:08:48.388 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 78ms. Found 6 JPA repository interfaces.
2021-01-16 13:08:48.902 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:08:48.910 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:08:48.910 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:08:48.911 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:08:49.017 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:08:49.018 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1467 ms
2021-01-16 13:08:49.116 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:08:49.183 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:08:49.820 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:08:49.826 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:08:49.830 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:08:49.832 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:08:49.834 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:08:49.836 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:08:49.842 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:08:50.953 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-16 13:08:50.954 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-16 13:08:50.955 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:08:50.956 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-16 13:08:50.956 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-16 13:08:50.956 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:08:50.965 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-16 13:08:50.967 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-16 13:08:50.968 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-16 13:08:50.970 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:50.970 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 7ms
2021-01-16 13:08:50.971 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:08:50.977 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:50.990 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-16 13:08:50.991 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-16 13:08:50.993 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-16 13:08:50.993 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:50.994 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 6ms
2021-01-16 13:08:50.995 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:50.999 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-16 13:08:51.000 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:08:51.006 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-16 13:08:51.007 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.007 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 11ms
2021-01-16 13:08:51.008 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.009 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-16 13:08:51.009 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:08:51.011 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-16 13:08:51.011 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.011 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 3ms
2021-01-16 13:08:51.012 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.013 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-16 13:08:51.014 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-16 13:08:51.017 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.017 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 4ms
2021-01-16 13:08:51.018 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.020 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-16 13:08:51.033 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.034 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 15ms
2021-01-16 13:08:51.035 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.037 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-16 13:08:51.043 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.043 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 7ms
2021-01-16 13:08:51.044 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.048 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-16 13:08:51.049 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-16 13:08:51.052 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-16 13:08:51.053 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-16 13:08:51.055 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.055 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 9ms
2021-01-16 13:08:51.056 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.058 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-16 13:08:51.063 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:08:51.064 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 7ms
2021-01-16 13:08:51.065 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791730957')
2021-01-16 13:08:51.068 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:08:51.115 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-16 13:08:51.178 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-16 13:08:51.218 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-16 13:08:51.297 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-16 13:08:51.326 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-16 13:08:51.373 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-16 13:08:51.704 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@452aea78, org.springframework.security.web.context.SecurityContextPersistenceFilter@4daee083, org.springframework.security.web.header.HeaderWriterFilter@69e346b3, org.springframework.security.web.authentication.logout.LogoutFilter@39e0fe23, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@66f2ec1c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7fdf32a4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@49d658bf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2ca9e25a, org.springframework.security.web.session.SessionManagementFilter@4cc9d672, org.springframework.security.web.access.ExceptionTranslationFilter@1bb90d4d, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@52d0a5fe]
2021-01-16 13:08:51.896 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-16 13:08:51.902 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-16 13:08:51.916 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-16 13:08:51.942 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-16 13:08:52.306 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.309 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.309 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.388 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.389 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.389 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.389 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.389 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.390 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:08:52.452 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-16 13:08:52.774 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-16 13:08:52.783 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 5.659 seconds (JVM running for 6.186)
2021-01-16 13:09:45.117 INFO  [http-nio-8080-exec-1] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-16 13:09:45.118 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-16 13:09:45.124 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Completed initialization in 6 ms
2021-01-16 13:09:45.213 INFO  [http-nio-8080-exec-1] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with argument[s] = authorizationRequest=AuthorizationRequestDTO{email='test@mail.com'}, 
2021-01-16 13:09:45.216 INFO  [http-nio-8080-exec-1] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with argument[s] = rawPassword=userNotFoundPassword, 
2021-01-16 13:09:45.366 INFO  [http-nio-8080-exec-1] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with result = i1pU2DS4NAZmp/ZbJ8QzNrJcYfVNPUJMkGKaQYSAxFM=
2021-01-16 13:09:45.440 ERROR [http-nio-8080-exec-1] [ResponseExceptionHandler] : AuthorizationFailureException handling started. 
ru.bolshakov.internship.dishes_rating.exception.NotFoundException: User with such email not found
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.lambda$loadUserByUsername$0(UserDetailsServiceImpl.java:22)
	at java.base/java.util.Optional.orElseThrow(Optional.java:401)
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.loadUserByUsername(UserDetailsServiceImpl.java:22)
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:108)
	... 113 common frames omitted
Wrapped by: org.springframework.security.authentication.InternalAuthenticationServiceException: User with such email not found
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:123)
	at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:144)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:199)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:219)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter$AuthenticationManagerDelegator.authenticate(WebSecurityConfigurerAdapter.java:534)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:30)
	... 108 common frames omitted
Wrapped by: ru.bolshakov.internship.dishes_rating.exception.AuthorizationFailureException: Authorization failure
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:35)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$FastClassBySpringCGLIB$$1745ae1b.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at ru.bolshakov.internship.dishes_rating.aspect.LoggingAspect.logAround(LoggingAspect.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$EnhancerBySpringCGLIB$$a8fcbe6.authorize(<generated>)
	at ru.bolshakov.internship.dishes_rating.controller.user.UserLoginController.authorize(UserLoginController.java:49)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:126)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:158)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:92)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:77)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:832)
2021-01-16 13:10:13.309 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:10:13.323 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 2100 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:10:13.324 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:10:14.175 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:10:14.269 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 89ms. Found 6 JPA repository interfaces.
2021-01-16 13:10:14.773 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:10:14.779 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:10:14.780 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:10:14.780 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:10:14.896 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:10:14.896 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1540 ms
2021-01-16 13:10:14.997 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:10:15.074 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:10:15.823 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:10:15.829 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:10:15.834 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:10:15.840 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:10:15.842 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:10:15.845 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:10:15.852 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:10:17.444 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-16 13:10:17.446 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-16 13:10:17.447 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:10:17.448 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-16 13:10:17.449 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-16 13:10:17.450 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:10:17.461 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-16 13:10:17.464 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-16 13:10:17.467 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-16 13:10:17.470 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.470 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 12ms
2021-01-16 13:10:17.471 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:10:17.475 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.482 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-16 13:10:17.483 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-16 13:10:17.483 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-16 13:10:17.484 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.484 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 3ms
2021-01-16 13:10:17.485 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.492 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-16 13:10:17.493 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:10:17.503 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-16 13:10:17.503 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.503 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 17ms
2021-01-16 13:10:17.504 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.506 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-16 13:10:17.506 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:10:17.508 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-16 13:10:17.509 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.509 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 4ms
2021-01-16 13:10:17.510 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.512 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-16 13:10:17.512 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-16 13:10:17.514 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.514 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 3ms
2021-01-16 13:10:17.515 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.516 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-16 13:10:17.523 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.523 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 8ms
2021-01-16 13:10:17.524 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.525 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-16 13:10:17.528 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.528 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 4ms
2021-01-16 13:10:17.530 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.534 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-16 13:10:17.535 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-16 13:10:17.538 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-16 13:10:17.540 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-16 13:10:17.542 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.542 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 10ms
2021-01-16 13:10:17.543 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.544 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-16 13:10:17.549 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:10:17.549 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 5ms
2021-01-16 13:10:17.550 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791817450')
2021-01-16 13:10:17.552 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:10:17.590 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-16 13:10:17.646 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-16 13:10:17.681 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-16 13:10:17.767 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-16 13:10:17.801 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-16 13:10:17.852 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-16 13:10:18.333 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7abc838a, org.springframework.security.web.context.SecurityContextPersistenceFilter@6ce7d6ab, org.springframework.security.web.header.HeaderWriterFilter@1895f7fe, org.springframework.security.web.authentication.logout.LogoutFilter@3d587c73, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@2b682e9, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@21288943, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@109db924, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2ee91bdf, org.springframework.security.web.session.SessionManagementFilter@58e61e18, org.springframework.security.web.access.ExceptionTranslationFilter@5ded2dfc, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@4306709f]
2021-01-16 13:10:18.533 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-16 13:10:18.550 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-16 13:10:18.607 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-16 13:10:18.626 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-16 13:10:19.024 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.027 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.027 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.105 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.106 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.106 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.106 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.107 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.107 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:10:19.162 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-16 13:10:19.452 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-16 13:10:19.461 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 6.56 seconds (JVM running for 7.073)
2021-01-16 13:10:26.749 INFO  [http-nio-8080-exec-2] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-16 13:10:26.749 INFO  [http-nio-8080-exec-2] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-16 13:10:26.753 INFO  [http-nio-8080-exec-2] [FrameworkServlet] : Completed initialization in 4 ms
2021-01-16 13:10:26.838 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with argument[s] = authorizationRequest=AuthorizationRequestDTO{email='test@mail.com'}, 
2021-01-16 13:10:26.841 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with argument[s] = rawPassword=userNotFoundPassword, 
2021-01-16 13:10:26.996 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with result = Y8DYLA2QEh+9N5jKIkSrTr9cJtvgyQw17EJcRfkWiFA=
2021-01-16 13:10:27.072 ERROR [http-nio-8080-exec-2] [ResponseExceptionHandler] : AuthorizationFailureException handling started. 
ru.bolshakov.internship.dishes_rating.exception.NotFoundException: User with such email not found
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.lambda$loadUserByUsername$0(UserDetailsServiceImpl.java:22)
	at java.base/java.util.Optional.orElseThrow(Optional.java:401)
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.loadUserByUsername(UserDetailsServiceImpl.java:22)
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:108)
	... 113 common frames omitted
Wrapped by: org.springframework.security.authentication.InternalAuthenticationServiceException: User with such email not found
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:123)
	at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:144)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:199)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:219)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter$AuthenticationManagerDelegator.authenticate(WebSecurityConfigurerAdapter.java:534)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:30)
	... 108 common frames omitted
Wrapped by: ru.bolshakov.internship.dishes_rating.exception.AuthorizationFailureException: Authorization failure
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:35)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$FastClassBySpringCGLIB$$1745ae1b.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at ru.bolshakov.internship.dishes_rating.aspect.LoggingAspect.logAround(LoggingAspect.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$EnhancerBySpringCGLIB$$97461452.authorize(<generated>)
	at ru.bolshakov.internship.dishes_rating.controller.user.UserLoginController.authorize(UserLoginController.java:49)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:126)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:158)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:92)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:77)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:832)
2021-01-16 13:12:12.012 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:12:12.026 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 1956 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:12:12.027 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:12:12.842 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:12:12.925 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 78ms. Found 6 JPA repository interfaces.
2021-01-16 13:12:13.403 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:12:13.411 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:12:13.412 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:12:13.412 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:12:13.511 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:12:13.511 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1450 ms
2021-01-16 13:12:13.626 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:12:13.709 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:12:14.345 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:12:14.350 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:12:14.354 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:12:14.357 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:12:14.358 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:12:14.360 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:12:14.366 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:12:15.450 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-16 13:12:15.451 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-16 13:12:15.452 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:12:15.453 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-16 13:12:15.453 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-16 13:12:15.454 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:12:15.462 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-16 13:12:15.463 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-16 13:12:15.465 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-16 13:12:15.467 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.467 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 7ms
2021-01-16 13:12:15.467 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:12:15.470 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.476 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-16 13:12:15.476 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-16 13:12:15.477 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-16 13:12:15.478 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.478 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 3ms
2021-01-16 13:12:15.478 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.480 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-16 13:12:15.480 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:12:15.486 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-16 13:12:15.487 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.487 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 8ms
2021-01-16 13:12:15.487 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.489 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-16 13:12:15.489 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:12:15.490 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-16 13:12:15.491 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.491 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 3ms
2021-01-16 13:12:15.492 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.493 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-16 13:12:15.493 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-16 13:12:15.495 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.495 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 3ms
2021-01-16 13:12:15.495 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.496 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-16 13:12:15.503 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.503 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 7ms
2021-01-16 13:12:15.503 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.504 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-16 13:12:15.507 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.507 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 3ms
2021-01-16 13:12:15.508 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.509 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-16 13:12:15.510 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-16 13:12:15.514 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-16 13:12:15.515 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-16 13:12:15.517 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.517 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 8ms
2021-01-16 13:12:15.518 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.520 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-16 13:12:15.527 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:12:15.528 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 9ms
2021-01-16 13:12:15.529 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0791935454')
2021-01-16 13:12:15.531 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:12:15.572 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-16 13:12:15.632 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-16 13:12:15.670 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-16 13:12:15.746 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-16 13:12:15.786 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-16 13:12:15.825 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-16 13:12:16.171 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@452aea78, org.springframework.security.web.context.SecurityContextPersistenceFilter@4daee083, org.springframework.security.web.header.HeaderWriterFilter@69e346b3, org.springframework.security.web.authentication.logout.LogoutFilter@39e0fe23, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@349f0ca4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7fdf32a4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@49d658bf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2ca9e25a, org.springframework.security.web.session.SessionManagementFilter@4cc9d672, org.springframework.security.web.access.ExceptionTranslationFilter@1bb90d4d, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@52d0a5fe]
2021-01-16 13:12:16.307 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-16 13:12:16.314 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-16 13:12:16.426 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-16 13:12:16.445 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-16 13:12:16.804 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.809 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.810 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.938 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.939 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.940 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.940 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.941 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:12:16.942 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:12:17.002 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-16 13:12:17.288 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-16 13:12:17.297 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 5.664 seconds (JVM running for 6.203)
2021-01-16 13:12:27.681 INFO  [http-nio-8080-exec-1] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-16 13:12:27.682 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-16 13:12:27.687 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Completed initialization in 5 ms
2021-01-16 13:12:27.768 INFO  [http-nio-8080-exec-1] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with argument[s] = authorizationRequest=AuthorizationRequestDTO{email='test@mail.com'}, 
2021-01-16 13:12:27.771 INFO  [http-nio-8080-exec-1] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with argument[s] = rawPassword=userNotFoundPassword, 
2021-01-16 13:12:27.926 INFO  [http-nio-8080-exec-1] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with result = 3/tvpqdJr0wpC8+y0hZ070hTuentcPWo14UyX968Xs8=
2021-01-16 13:12:28.000 ERROR [http-nio-8080-exec-1] [ResponseExceptionHandler] : AuthorizationFailureException handling started. 
ru.bolshakov.internship.dishes_rating.exception.NotFoundException: User with such email not found
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.lambda$loadUserByUsername$0(UserDetailsServiceImpl.java:22)
	at java.base/java.util.Optional.orElseThrow(Optional.java:401)
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.loadUserByUsername(UserDetailsServiceImpl.java:22)
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:108)
	... 113 common frames omitted
Wrapped by: org.springframework.security.authentication.InternalAuthenticationServiceException: User with such email not found
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:123)
	at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:144)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:199)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:219)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter$AuthenticationManagerDelegator.authenticate(WebSecurityConfigurerAdapter.java:534)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:30)
	... 108 common frames omitted
Wrapped by: ru.bolshakov.internship.dishes_rating.exception.AuthorizationFailureException: Authorization failure
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:35)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$FastClassBySpringCGLIB$$1745ae1b.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at ru.bolshakov.internship.dishes_rating.aspect.LoggingAspect.logAround(LoggingAspect.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$EnhancerBySpringCGLIB$$fa45c456.authorize(<generated>)
	at ru.bolshakov.internship.dishes_rating.controller.user.UserLoginController.authorize(UserLoginController.java:49)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:126)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:158)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:92)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:77)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:832)
2021-01-16 13:20:29.660 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:20:29.675 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 11620 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:20:29.676 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:20:30.492 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:20:30.577 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 79ms. Found 6 JPA repository interfaces.
2021-01-16 13:20:31.049 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:20:31.056 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:20:31.057 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:20:31.057 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:20:31.196 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:20:31.196 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1480 ms
2021-01-16 13:20:31.297 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:20:31.369 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:20:31.988 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:20:31.994 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:20:31.999 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:20:32.002 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:20:32.003 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:20:32.005 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:20:32.011 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:20:33.091 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:20:33.093 WARN  [main] [AbstractApplicationContext] : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'liquibase' defined in class path resource [org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]: Invocation of init method failed; nested exception is liquibase.exception.ChangeLogParseException: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
2021-01-16 13:20:33.094 INFO  [main] [HikariDataSource] : HikariPool-1 - Shutdown initiated...
2021-01-16 13:20:33.096 INFO  [main] [HikariDataSource] : HikariPool-1 - Shutdown completed.
2021-01-16 13:20:33.098 INFO  [main] [DirectJDKLog] : Stopping service [Tomcat]
2021-01-16 13:20:33.107 INFO  [main] [ConditionEvaluationReportLoggingListener] : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2021-01-16 13:20:33.113 ERROR [main] [SpringApplication] : Application run failed
java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at org.springframework.core.io.ClassPathResource.getURL(ClassPathResource.java:195)
	at liquibase.integration.spring.SpringLiquibase$SpringResourceOpener.getResourcesAsStream(SpringLiquibase.java:613)
	at liquibase.util.StreamUtil.singleInputStream(StreamUtil.java:186)
	at liquibase.parser.core.sql.SqlChangeLogParser.parse(SqlChangeLogParser.java:37)
	... 30 common frames omitted
Wrapped by: liquibase.exception.ChangeLogParseException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at liquibase.parser.core.sql.SqlChangeLogParser.parse(SqlChangeLogParser.java:44)
	at liquibase.changelog.DatabaseChangeLog.include(DatabaseChangeLog.java:565)
	at liquibase.changelog.DatabaseChangeLog.handleChildNode(DatabaseChangeLog.java:348)
	... 28 common frames omitted
Wrapped by: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at liquibase.changelog.DatabaseChangeLog.handleChildNode(DatabaseChangeLog.java:356)
	at liquibase.changelog.DatabaseChangeLog.load(DatabaseChangeLog.java:305)
	at liquibase.parser.core.xml.AbstractChangeLogParser.parse(AbstractChangeLogParser.java:23)
	... 26 common frames omitted
Wrapped by: liquibase.exception.ChangeLogParseException: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at liquibase.parser.core.xml.AbstractChangeLogParser.parse(AbstractChangeLogParser.java:25)
	at liquibase.Liquibase.getDatabaseChangeLog(Liquibase.java:217)
	at liquibase.Liquibase.update(Liquibase.java:190)
	at liquibase.Liquibase.update(Liquibase.java:179)
	at liquibase.integration.spring.SpringLiquibase.performUpdate(SpringLiquibase.java:366)
	at liquibase.integration.spring.SpringLiquibase.afterPropertiesSet(SpringLiquibase.java:314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1853)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1790)
	... 19 common frames omitted
Wrapped by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'liquibase' defined in class path resource [org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]: Invocation of init method failed; nested exception is liquibase.exception.ChangeLogParseException: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1794)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:594)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:516)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:324)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:322)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:311)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1109)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:869)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:551)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at ru.bolshakov.internship.dishes_rating.DishesRatingApplication.main(DishesRatingApplication.java:19)
2021-01-16 13:21:14.338 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:21:14.350 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 13944 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:21:14.351 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:21:15.253 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:21:15.346 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 87ms. Found 6 JPA repository interfaces.
2021-01-16 13:21:15.807 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:21:15.813 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:21:15.813 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:21:15.814 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:21:15.913 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:21:15.913 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1523 ms
2021-01-16 13:21:16.017 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:21:16.117 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:21:16.703 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:21:16.709 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:21:16.712 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:21:16.715 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:21:16.716 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:21:16.718 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:21:16.724 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:21:17.787 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:21:17.789 WARN  [main] [AbstractApplicationContext] : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'liquibase' defined in class path resource [org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]: Invocation of init method failed; nested exception is liquibase.exception.ChangeLogParseException: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
2021-01-16 13:21:17.789 INFO  [main] [HikariDataSource] : HikariPool-1 - Shutdown initiated...
2021-01-16 13:21:17.791 INFO  [main] [HikariDataSource] : HikariPool-1 - Shutdown completed.
2021-01-16 13:21:17.794 INFO  [main] [DirectJDKLog] : Stopping service [Tomcat]
2021-01-16 13:21:17.803 INFO  [main] [ConditionEvaluationReportLoggingListener] : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2021-01-16 13:21:17.809 ERROR [main] [SpringApplication] : Application run failed
java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at org.springframework.core.io.ClassPathResource.getURL(ClassPathResource.java:195)
	at liquibase.integration.spring.SpringLiquibase$SpringResourceOpener.getResourcesAsStream(SpringLiquibase.java:613)
	at liquibase.util.StreamUtil.singleInputStream(StreamUtil.java:186)
	at liquibase.parser.core.sql.SqlChangeLogParser.parse(SqlChangeLogParser.java:37)
	... 30 common frames omitted
Wrapped by: liquibase.exception.ChangeLogParseException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at liquibase.parser.core.sql.SqlChangeLogParser.parse(SqlChangeLogParser.java:44)
	at liquibase.changelog.DatabaseChangeLog.include(DatabaseChangeLog.java:565)
	at liquibase.changelog.DatabaseChangeLog.handleChildNode(DatabaseChangeLog.java:348)
	... 28 common frames omitted
Wrapped by: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at liquibase.changelog.DatabaseChangeLog.handleChildNode(DatabaseChangeLog.java:356)
	at liquibase.changelog.DatabaseChangeLog.load(DatabaseChangeLog.java:305)
	at liquibase.parser.core.xml.AbstractChangeLogParser.parse(AbstractChangeLogParser.java:23)
	... 26 common frames omitted
Wrapped by: liquibase.exception.ChangeLogParseException: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at liquibase.parser.core.xml.AbstractChangeLogParser.parse(AbstractChangeLogParser.java:25)
	at liquibase.Liquibase.getDatabaseChangeLog(Liquibase.java:217)
	at liquibase.Liquibase.update(Liquibase.java:190)
	at liquibase.Liquibase.update(Liquibase.java:179)
	at liquibase.integration.spring.SpringLiquibase.performUpdate(SpringLiquibase.java:366)
	at liquibase.integration.spring.SpringLiquibase.afterPropertiesSet(SpringLiquibase.java:314)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1853)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1790)
	... 19 common frames omitted
Wrapped by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'liquibase' defined in class path resource [org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]: Invocation of init method failed; nested exception is liquibase.exception.ChangeLogParseException: liquibase.exception.SetupException: java.io.FileNotFoundException: class path resource [db/changelog/10_populate_schemas.sql] cannot be resolved to URL because it does not exist
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1794)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:594)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:516)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:324)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:322)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:311)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1109)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:869)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:551)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at ru.bolshakov.internship.dishes_rating.DishesRatingApplication.main(DishesRatingApplication.java:19)
2021-01-16 13:22:00.075 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:22:00.088 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 13820 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:22:00.089 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:22:00.928 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:22:01.033 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 99ms. Found 6 JPA repository interfaces.
2021-01-16 13:22:01.506 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:22:01.512 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:22:01.513 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:22:01.513 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:22:01.632 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:22:01.633 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1504 ms
2021-01-16 13:22:01.734 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:22:01.812 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:22:02.421 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:22:02.427 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:22:02.431 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:22:02.434 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:22:02.436 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:22:02.438 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:22:02.444 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:22:03.535 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-16 13:22:03.537 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-16 13:22:03.538 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:22:03.538 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-16 13:22:03.538 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-16 13:22:03.539 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:22:03.547 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-16 13:22:03.549 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-16 13:22:03.551 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-16 13:22:03.552 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.553 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 7ms
2021-01-16 13:22:03.553 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:22:03.556 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.562 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-16 13:22:03.563 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-16 13:22:03.563 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-16 13:22:03.564 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.564 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 3ms
2021-01-16 13:22:03.564 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.566 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-16 13:22:03.566 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:22:03.573 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-16 13:22:03.573 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.573 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 8ms
2021-01-16 13:22:03.574 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.575 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-16 13:22:03.575 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:22:03.577 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-16 13:22:03.577 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.578 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 4ms
2021-01-16 13:22:03.578 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.579 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-16 13:22:03.580 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-16 13:22:03.581 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.581 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 2ms
2021-01-16 13:22:03.582 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.582 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-16 13:22:03.588 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.588 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 6ms
2021-01-16 13:22:03.589 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.590 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-16 13:22:03.592 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.593 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 4ms
2021-01-16 13:22:03.593 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.595 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-16 13:22:03.595 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-16 13:22:03.596 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-16 13:22:03.597 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-16 13:22:03.598 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.598 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 4ms
2021-01-16 13:22:03.598 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.599 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-16 13:22:03.603 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.604 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 5ms
2021-01-16 13:22:03.604 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.605 INFO  [main] [Slf4jLogger] : INSERT INTO users (id, user_name, email, password, role, enabled)
VALUES (1, 'Username', 'test@email.com', '2WTcIqpSpWNPzxYzKYUBmVWLNXDjHowpgQjn4X0W/RA=', 'ADMIN', true)
2021-01-16 13:22:03.606 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:22:03.606 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/10_populate_schemas.sql::10::Bolshakov ran successfully in 1ms
2021-01-16 13:22:03.607 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('10', 'Bolshakov', 'classpath:db/changelog/changesets/10_populate_schemas.sql', NOW(), 10, '8:cf25f9006cf15793678eab82e7e26dbe', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792523539')
2021-01-16 13:22:03.608 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:22:03.641 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-16 13:22:03.701 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-16 13:22:03.745 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-16 13:22:03.824 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-16 13:22:03.836 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-16 13:22:03.907 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-16 13:22:04.243 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1828eff, org.springframework.security.web.context.SecurityContextPersistenceFilter@50ccd6a, org.springframework.security.web.header.HeaderWriterFilter@24e6bd00, org.springframework.security.web.authentication.logout.LogoutFilter@68226b59, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@351e89fc, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@26c7940a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@2c6c6b7b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5118c7fb, org.springframework.security.web.session.SessionManagementFilter@7227e3f1, org.springframework.security.web.access.ExceptionTranslationFilter@3a89f2a0, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@1925b113]
2021-01-16 13:22:04.408 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-16 13:22:04.414 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-16 13:22:04.453 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-16 13:22:04.484 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-16 13:22:04.888 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.893 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.893 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.974 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.974 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.975 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.975 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.975 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:22:04.976 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:22:05.026 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-16 13:22:05.344 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-16 13:22:05.354 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 5.691 seconds (JVM running for 6.215)
2021-01-16 13:22:09.184 INFO  [http-nio-8080-exec-2] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-16 13:22:09.184 INFO  [http-nio-8080-exec-2] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-16 13:22:09.190 INFO  [http-nio-8080-exec-2] [FrameworkServlet] : Completed initialization in 6 ms
2021-01-16 13:22:09.295 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with argument[s] = authorizationRequest=AuthorizationRequestDTO{email='test@mail.com'}, 
2021-01-16 13:22:09.298 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with argument[s] = rawPassword=userNotFoundPassword, 
2021-01-16 13:22:09.449 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with result = gWZPPldNvT+6jWsmjg7/27bmeTQ/fTtPLWAS3o/nM/Y=
2021-01-16 13:22:09.542 ERROR [http-nio-8080-exec-2] [ResponseExceptionHandler] : AuthorizationFailureException handling started. 
ru.bolshakov.internship.dishes_rating.exception.NotFoundException: User with such email not found
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.lambda$loadUserByUsername$0(UserDetailsServiceImpl.java:22)
	at java.base/java.util.Optional.orElseThrow(Optional.java:401)
	at ru.bolshakov.internship.dishes_rating.security.UserDetailsServiceImpl.loadUserByUsername(UserDetailsServiceImpl.java:22)
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:108)
	... 113 common frames omitted
Wrapped by: org.springframework.security.authentication.InternalAuthenticationServiceException: User with such email not found
	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:123)
	at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:144)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:199)
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:219)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter$AuthenticationManagerDelegator.authenticate(WebSecurityConfigurerAdapter.java:534)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:30)
	... 108 common frames omitted
Wrapped by: ru.bolshakov.internship.dishes_rating.exception.AuthorizationFailureException: Authorization failure
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize(AuthorizationService.java:35)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$FastClassBySpringCGLIB$$1745ae1b.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at ru.bolshakov.internship.dishes_rating.aspect.LoggingAspect.logAround(LoggingAspect.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at ru.bolshakov.internship.dishes_rating.service.AuthorizationService$$EnhancerBySpringCGLIB$$57b3ed06.authorize(<generated>)
	at ru.bolshakov.internship.dishes_rating.controller.user.UserLoginController.authorize(UserLoginController.java:49)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:126)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:158)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter.doFilter(JwtTokenFilter.java:39)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:92)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:77)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:832)
2021-01-16 13:22:56.036 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with argument[s] = authorizationRequest=AuthorizationRequestDTO{email='test@email.com'}, 
2021-01-16 13:22:56.050 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.matches() with argument[s] = rawPassword=password123, encodedPassword=2WTcIqpSpWNPzxYzKYUBmVWLNXDjHowpgQjn4X0W/RA=, 
2021-01-16 13:22:56.177 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.matches() with result = true
2021-01-16 13:22:56.183 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.UserService.getByEmail() with argument[s] = email=test@email.com, 
2021-01-16 13:22:56.188 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.UserService.getByEmail() with result = UserTo{id=1, userName='Username', email='test@email.com', role='ADMIN'}
2021-01-16 13:22:56.208 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with result = RefreshedTokenResponseDTO{accessToken='eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0QGVtYWlsLmNvbSIsImlkIjoxLCJpYXQiOjE2MTA3OTI1NzYsImV4cCI6MTYxMDg3ODk3Nn0.pZKv9Yj1LhkVW-9s8VEaj8t4SLO0jMznYJq9-kwjrjE', refreshToken='eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0QGVtYWlsLmNvbSIsImlkIjoxLCJpYXQiOjE2MTA3OTI1NzYsImV4cCI6MTYxMDg4MjU3Nn0.N1QVGGlN1ZKO_7-JNUxp8m5E-X4kiIeNKB6YJ1H0-vE'}
2021-01-16 13:25:04.912 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-16 13:25:04.928 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 20664 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-16 13:25:04.929 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-16 13:25:05.743 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-16 13:25:05.826 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 78ms. Found 6 JPA repository interfaces.
2021-01-16 13:25:06.321 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-16 13:25:06.327 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-16 13:25:06.328 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-16 13:25:06.328 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-16 13:25:06.427 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-16 13:25:06.428 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1459 ms
2021-01-16 13:25:06.526 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-16 13:25:06.599 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-16 13:25:07.314 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:25:07.320 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-16 13:25:07.329 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:25:07.336 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:25:07.339 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-16 13:25:07.344 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-16 13:25:07.354 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-16 13:25:08.459 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-16 13:25:08.460 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-16 13:25:08.461 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:25:08.462 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-16 13:25:08.462 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-16 13:25:08.463 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-16 13:25:08.472 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-16 13:25:08.473 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-16 13:25:08.474 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-16 13:25:08.476 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.476 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 6ms
2021-01-16 13:25:08.477 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-16 13:25:08.480 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.485 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-16 13:25:08.486 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-16 13:25:08.487 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-16 13:25:08.487 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.487 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 2ms
2021-01-16 13:25:08.488 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.490 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-16 13:25:08.490 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:25:08.496 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-16 13:25:08.501 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.501 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 13ms
2021-01-16 13:25:08.502 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.504 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-16 13:25:08.505 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-16 13:25:08.507 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-16 13:25:08.507 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.508 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 5ms
2021-01-16 13:25:08.508 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.510 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-16 13:25:08.510 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-16 13:25:08.512 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.512 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 3ms
2021-01-16 13:25:08.513 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.514 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-16 13:25:08.521 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.522 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 8ms
2021-01-16 13:25:08.522 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.523 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-16 13:25:08.526 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.526 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 3ms
2021-01-16 13:25:08.526 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.528 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-16 13:25:08.528 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-16 13:25:08.530 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-16 13:25:08.530 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-16 13:25:08.531 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.531 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 4ms
2021-01-16 13:25:08.531 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.532 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-16 13:25:08.535 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.535 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 3ms
2021-01-16 13:25:08.536 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.537 INFO  [main] [Slf4jLogger] : INSERT INTO users (id, user_name, email, password, role, enabled)
VALUES (1, 'Username', 'test@email.com', '2WTcIqpSpWNPzxYzKYUBmVWLNXDjHowpgQjn4X0W/RA=', 'ADMIN', true)
2021-01-16 13:25:08.538 INFO  [main] [Slf4jLogger] : INSERT INTO restaurant(id, restaurant_name, description)
VALUES (1, 'restaurant1', 'description1')
2021-01-16 13:25:08.539 INFO  [main] [Slf4jLogger] : INSERT INTO restaurant(id, restaurant_name, description)
VALUES (2, 'restaurant2', 'description2')
2021-01-16 13:25:08.539 INFO  [main] [Slf4jLogger] : INSERT INTO restaurant(id, restaurant_name, description)
VALUES (3, 'restaurant3', 'description3')
2021-01-16 13:25:08.539 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-16 13:25:08.539 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/10_populate_schemas.sql::10::Bolshakov ran successfully in 3ms
2021-01-16 13:25:08.540 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('10', 'Bolshakov', 'classpath:db/changelog/changesets/10_populate_schemas.sql', NOW(), 10, '8:6904a9949436a8a8b5d4e86ae1e5f0dd', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0792708463')
2021-01-16 13:25:08.541 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-16 13:25:08.574 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-16 13:25:08.635 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-16 13:25:08.669 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-16 13:25:08.748 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-16 13:25:08.789 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-16 13:25:08.821 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-16 13:25:09.162 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7afffc81, org.springframework.security.web.context.SecurityContextPersistenceFilter@109db924, org.springframework.security.web.header.HeaderWriterFilter@41f57420, org.springframework.security.web.authentication.logout.LogoutFilter@36361951, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@12e5d3e1, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7cc8fd4b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@26c7940a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@730c9287, org.springframework.security.web.session.SessionManagementFilter@2ab91b65, org.springframework.security.web.access.ExceptionTranslationFilter@5c3cc103, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@2c62f56f]
2021-01-16 13:25:09.318 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-16 13:25:09.324 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-16 13:25:09.369 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-16 13:25:09.391 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-16 13:25:09.754 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.757 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.757 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.828 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.829 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.829 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.829 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.829 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.830 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-16 13:25:09.888 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-16 13:25:10.205 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-16 13:25:10.214 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 5.678 seconds (JVM running for 6.203)
2021-01-16 13:25:17.837 INFO  [http-nio-8080-exec-2] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-16 13:25:17.838 INFO  [http-nio-8080-exec-2] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-16 13:25:17.847 INFO  [http-nio-8080-exec-2] [FrameworkServlet] : Completed initialization in 9 ms
2021-01-16 13:25:17.957 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with argument[s] = authorizationRequest=AuthorizationRequestDTO{email='test@email.com'}, 
2021-01-16 13:25:17.961 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with argument[s] = rawPassword=userNotFoundPassword, 
2021-01-16 13:25:18.115 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.encode() with result = n+oAHUUkkxQ8iC8EuuvQTIs6rkbWg3bu8pHlzlmg7es=
2021-01-16 13:25:18.197 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.PasswordService.matches() with argument[s] = rawPassword=password123, encodedPassword=2WTcIqpSpWNPzxYzKYUBmVWLNXDjHowpgQjn4X0W/RA=, 
2021-01-16 13:25:18.324 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.PasswordService.matches() with result = true
2021-01-16 13:25:18.331 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.UserService.getByEmail() with argument[s] = email=test@email.com, 
2021-01-16 13:25:18.335 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.UserService.getByEmail() with result = UserTo{id=1, userName='Username', email='test@email.com', role='ADMIN'}
2021-01-16 13:25:18.358 INFO  [http-nio-8080-exec-2] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.AuthorizationService.authorize() with result = RefreshedTokenResponseDTO{accessToken='eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0QGVtYWlsLmNvbSIsImlkIjoxLCJpYXQiOjE2MTA3OTI3MTgsImV4cCI6MTYxMDg3OTExOH0.tUUofKdzpyeWkYjnGFQlmsv4UbFzZNmFC7ylEF3J5vQ', refreshToken='eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0QGVtYWlsLmNvbSIsImlkIjoxLCJpYXQiOjE2MTA3OTI3MTgsImV4cCI6MTYxMDg4MjcxOH0.ka6DGe9OgNHu3CnypX0ar8VOnpS-c-_JOLmbMlRvekU'}
2021-01-16 13:25:34.142 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Enter: ru.bolshakov.internship.dishes_rating.service.RestaurantService.getAllWithRatingByDate() with argument[s] = pageable=Page request [number: 0, size 20, sort: UNSORTED], searchRequest=ru.bolshakov.internship.dishes_rating.dto.search.SearchRequest@745f, 
2021-01-16 13:25:34.166 INFO  [http-nio-8080-exec-3] [LoggingAspect] : Exit: ru.bolshakov.internship.dishes_rating.service.RestaurantService.getAllWithRatingByDate() with result = [RestaurantDTO{id=1, restaurantName='restaurant1', description='description1', rating=null}, RestaurantDTO{id=2, restaurantName='restaurant2', description='description2', rating=null}, RestaurantDTO{id=3, restaurantName='restaurant3', description='description3', rating=null}]
