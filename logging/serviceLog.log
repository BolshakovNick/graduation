2021-01-11 15:55:43.526 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-11 15:55:43.545 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 14628 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-11 15:55:43.546 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-11 15:55:44.324 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-11 15:55:44.424 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 94ms. Found 6 JPA repository interfaces.
2021-01-11 15:55:44.902 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-11 15:55:44.910 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-11 15:55:44.910 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-11 15:55:44.910 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-11 15:55:45.035 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-11 15:55:45.035 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1446 ms
2021-01-11 15:55:45.133 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-11 15:55:45.225 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-11 15:55:45.937 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 15:55:45.942 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-11 15:55:45.946 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 15:55:45.949 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 15:55:45.950 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-11 15:55:45.952 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-11 15:55:45.958 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-11 15:55:47.040 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-11 15:55:47.041 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-11 15:55:47.042 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-11 15:55:47.042 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-11 15:55:47.042 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-11 15:55:47.043 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 15:55:47.055 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-11 15:55:47.056 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-11 15:55:47.058 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-11 15:55:47.060 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.060 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 8ms
2021-01-11 15:55:47.061 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-11 15:55:47.063 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.070 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-11 15:55:47.070 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-11 15:55:47.071 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-11 15:55:47.071 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.071 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 2ms
2021-01-11 15:55:47.072 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.074 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-11 15:55:47.074 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-11 15:55:47.080 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-11 15:55:47.081 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.082 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 10ms
2021-01-11 15:55:47.083 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.086 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-11 15:55:47.087 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-11 15:55:47.091 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-11 15:55:47.092 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.093 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 9ms
2021-01-11 15:55:47.094 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.097 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-11 15:55:47.098 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-11 15:55:47.101 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.101 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 6ms
2021-01-11 15:55:47.102 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.104 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-11 15:55:47.118 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.118 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 14ms
2021-01-11 15:55:47.119 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.121 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-11 15:55:47.124 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.124 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 4ms
2021-01-11 15:55:47.125 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.126 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-11 15:55:47.127 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-11 15:55:47.128 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-11 15:55:47.129 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-11 15:55:47.130 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.130 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 5ms
2021-01-11 15:55:47.130 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.131 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-11 15:55:47.134 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 15:55:47.134 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 3ms
2021-01-11 15:55:47.135 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0369747043')
2021-01-11 15:55:47.136 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-11 15:55:47.171 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-11 15:55:47.226 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-11 15:55:47.263 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-11 15:55:47.342 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-11 15:55:47.361 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-11 15:55:47.424 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-11 15:55:47.761 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7b5afde5, org.springframework.security.web.context.SecurityContextPersistenceFilter@73c21b13, org.springframework.security.web.header.HeaderWriterFilter@636d4cdc, org.springframework.security.web.authentication.logout.LogoutFilter@2c62f56f, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@2084e65a, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1964a3f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@de06f28, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5a14a8c1, org.springframework.security.web.session.SessionManagementFilter@5536542e, org.springframework.security.web.access.ExceptionTranslationFilter@56a7f57f, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@2140582]
2021-01-11 15:55:47.941 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-11 15:55:47.948 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-11 15:55:47.966 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-11 15:55:47.985 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-11 15:55:48.346 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.350 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.350 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.414 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.414 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.415 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.415 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.415 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.415 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-11 15:55:48.463 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-11 15:55:48.763 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-11 15:55:48.783 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 5.714 seconds (JVM running for 6.289)
2021-01-11 15:55:58.473 INFO  [http-nio-8080-exec-1] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-11 15:55:58.473 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-11 15:55:58.478 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Completed initialization in 5 ms
2021-01-11 16:00:05.707 INFO  [background-preinit] [Version] : HV000001: Hibernate Validator 6.1.5.Final
2021-01-11 16:00:05.723 INFO  [main] [StartupInfoLogger] : Starting DishesRatingApplication on DESKTOP-CDPVALQ with PID 26172 (C:\projectsJava\graduation\target\classes started by Local in C:\projectsJava\graduation)
2021-01-11 16:00:05.724 INFO  [main] [SpringApplication] : No active profile set, falling back to default profiles: default
2021-01-11 16:00:06.587 INFO  [main] [RepositoryConfigurationDelegate] : Bootstrapping Spring Data JPA repositories in DEFERRED mode.
2021-01-11 16:00:06.700 INFO  [main] [RepositoryConfigurationDelegate] : Finished Spring Data repository scanning in 107ms. Found 6 JPA repository interfaces.
2021-01-11 16:00:07.190 INFO  [main] [TomcatWebServer] : Tomcat initialized with port(s): 8080 (http)
2021-01-11 16:00:07.196 INFO  [main] [DirectJDKLog] : Initializing ProtocolHandler ["http-nio-8080"]
2021-01-11 16:00:07.197 INFO  [main] [DirectJDKLog] : Starting service [Tomcat]
2021-01-11 16:00:07.197 INFO  [main] [DirectJDKLog] : Starting Servlet engine: [Apache Tomcat/9.0.38]
2021-01-11 16:00:07.315 INFO  [main] [DirectJDKLog] : Initializing Spring embedded WebApplicationContext
2021-01-11 16:00:07.315 INFO  [main] [ServletWebServerApplicationContext] : Root WebApplicationContext: initialization completed in 1544 ms
2021-01-11 16:00:07.428 INFO  [main] [HikariDataSource] : HikariPool-1 - Starting...
2021-01-11 16:00:07.520 INFO  [main] [HikariDataSource] : HikariPool-1 - Start completed.
2021-01-11 16:00:08.160 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 16:00:08.165 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOGLOCK (ID INT NOT NULL, LOCKED BOOLEAN NOT NULL, LOCKGRANTED TIMESTAMP, LOCKEDBY VARCHAR(255), CONSTRAINT PK_DATABASECHANGELOGLOCK PRIMARY KEY (ID))
2021-01-11 16:00:08.169 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 16:00:08.172 INFO  [main] [Slf4jLogger] : DELETE FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 16:00:08.173 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOGLOCK (ID, LOCKED) VALUES (1, FALSE)
2021-01-11 16:00:08.176 INFO  [main] [Slf4jLogger] : SELECT LOCKED FROM PUBLIC.DATABASECHANGELOGLOCK WHERE ID=1
2021-01-11 16:00:08.181 INFO  [main] [Slf4jLogger] : Successfully acquired change log lock
2021-01-11 16:00:09.259 INFO  [main] [Slf4jLogger] : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2021-01-11 16:00:09.261 INFO  [main] [Slf4jLogger] : CREATE TABLE PUBLIC.DATABASECHANGELOG (ID VARCHAR(255) NOT NULL, AUTHOR VARCHAR(255) NOT NULL, FILENAME VARCHAR(255) NOT NULL, DATEEXECUTED TIMESTAMP NOT NULL, ORDEREXECUTED INT NOT NULL, EXECTYPE VARCHAR(10) NOT NULL, MD5SUM VARCHAR(35), DESCRIPTION VARCHAR(255), COMMENTS VARCHAR(255), TAG VARCHAR(255), LIQUIBASE VARCHAR(20), CONTEXTS VARCHAR(255), LABELS VARCHAR(255), DEPLOYMENT_ID VARCHAR(10))
2021-01-11 16:00:09.262 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOG
2021-01-11 16:00:09.262 INFO  [main] [Slf4jLogger] : Reading from PUBLIC.DATABASECHANGELOG
2021-01-11 16:00:09.263 INFO  [main] [Slf4jLogger] : SELECT * FROM PUBLIC.DATABASECHANGELOG ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC
2021-01-11 16:00:09.263 INFO  [main] [Slf4jLogger] : SELECT COUNT(*) FROM PUBLIC.DATABASECHANGELOGLOCK
2021-01-11 16:00:09.277 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE user_id_seq START WITH 100000
2021-01-11 16:00:09.278 INFO  [main] [Slf4jLogger] : CREATE TABLE users
(
    id               BIGINT DEFAULT nextval('user_id_seq') PRIMARY KEY,
    user_name        VARCHAR(50)        NOT NULL,
    email            VARCHAR(256)       NOT NULL,
    password         VARCHAR(50)        NOT NULL,
    role             VARCHAR(5)         CHECK (role = 'USER' OR role = 'ADMIN')
)
2021-01-11 16:00:09.280 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX users_unique_email_idx ON users (email)
2021-01-11 16:00:09.282 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.282 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/1_init_schema_users.sql::1::Bolshakov ran successfully in 7ms
2021-01-11 16:00:09.283 INFO  [main] [Slf4jLogger] : SELECT MAX(ORDEREXECUTED) FROM PUBLIC.DATABASECHANGELOG
2021-01-11 16:00:09.286 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('1', 'Bolshakov', 'classpath:db/changelog/changesets/1_init_schema_users.sql', NOW(), 1, '8:652684d61eb8dc098c8be2e3fb7d75e0', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.292 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE restaurant_id_seq START WITH 100000
2021-01-11 16:00:09.292 INFO  [main] [Slf4jLogger] : CREATE TABLE restaurant
(
    id               BIGINT DEFAULT nextval('restaurant_id_seq') PRIMARY KEY,
    restaurant_name        VARCHAR(50)        NOT NULL,
    description            VARCHAR
)
2021-01-11 16:00:09.293 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX restaurant_unique_restaurant_name_idx ON restaurant (restaurant_name)
2021-01-11 16:00:09.293 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.293 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/2_init_schema_restaurant.sql::2::Bolshakov ran successfully in 2ms
2021-01-11 16:00:09.294 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('2', 'Bolshakov', 'classpath:db/changelog/changesets/2_init_schema_restaurant.sql', NOW(), 2, '8:f115d96bb1a30ccf5dc0f6c6e37526ea', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.296 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE vote_id_seq START WITH 100000
2021-01-11 16:00:09.296 INFO  [main] [Slf4jLogger] : CREATE TABLE vote
(
    id               BIGINT DEFAULT nextval('vote_id_seq') PRIMARY KEY,
    voting_datetime  TIMESTAMP                   NOT NULL,
    user_id          BIGINT                      NOT NULL,
    restaurant_id    BIGINT                              ,
    voting_date DATE AS (CAST(voting_datetime AS DATE)),
    CONSTRAINT vote_user_id_fkey FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT vote_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-11 16:00:09.302 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX vote_unique_user_id_voting_datetime_idx ON vote (user_id, voting_date)
2021-01-11 16:00:09.303 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.303 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/3_init_schema_vote.sql::3::Bolshakov ran successfully in 8ms
2021-01-11 16:00:09.303 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('3', 'Bolshakov', 'classpath:db/changelog/changesets/3_init_schema_vote.sql', NOW(), 3, '8:daa959ccf7414f13ed21e23570cce20b', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.305 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE menu_id_seq START WITH 100000
2021-01-11 16:00:09.305 INFO  [main] [Slf4jLogger] : CREATE TABLE menu
(
    id               BIGINT DEFAULT nextval('menu_id_seq') PRIMARY KEY,
    menu_date        DATE                    NOT NULL,
    restaurant_id    BIGINT                  NOT NULL,
    CONSTRAINT menu_restaurant_id_fkey FOREIGN KEY (restaurant_id) REFERENCES restaurant(id) ON DELETE CASCADE
)
2021-01-11 16:00:09.307 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX menu_unique_restaurant_id_menu_datetime_idx ON menu (restaurant_id, menu_date)
2021-01-11 16:00:09.307 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.307 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/4_init_schema_menu.sql::4::Bolshakov ran successfully in 3ms
2021-01-11 16:00:09.308 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('4', 'Bolshakov', 'classpath:db/changelog/changesets/4_init_schema_menu.sql', NOW(), 4, '8:0bde3fed763fdc0e1e8a4832ab3abff9', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.309 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE dish_id_seq START WITH 100000
2021-01-11 16:00:09.309 INFO  [main] [Slf4jLogger] : CREATE TABLE dish
(
    id               BIGINT DEFAULT nextval('dish_id_seq') PRIMARY KEY,
    menu_id          BIGINT        NOT NULL,
    dish_name        VARCHAR(50)   NOT NULL,
    price            INTEGER       NOT NULL,
    CONSTRAINT dish_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE
)
2021-01-11 16:00:09.311 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.311 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/5_init_schema_dish.sql::5::Bolshakov ran successfully in 3ms
2021-01-11 16:00:09.312 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('5', 'Bolshakov', 'classpath:db/changelog/changesets/5_init_schema_dish.sql', NOW(), 5, '8:d3ee0e5bcd6d65ccea0cd362aa4e8dfb', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.312 INFO  [main] [Slf4jLogger] : ALTER TABLE users ALTER column password TYPE VARCHAR
2021-01-11 16:00:09.318 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.319 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/6_remove_password_length_limitation.sql::6::Bolshakov ran successfully in 7ms
2021-01-11 16:00:09.319 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('6', 'Bolshakov', 'classpath:db/changelog/changesets/6_remove_password_length_limitation.sql', NOW(), 6, '8:92cb8348d2ebfef0f56eda93a0722893', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.320 INFO  [main] [Slf4jLogger] : ALTER TABLE dish ALTER column price TYPE BIGINT
2021-01-11 16:00:09.323 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.323 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/7_change_price_type.sql::7::Bolshakov ran successfully in 3ms
2021-01-11 16:00:09.324 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('7', 'Bolshakov', 'classpath:db/changelog/changesets/7_change_price_type.sql', NOW(), 7, '8:cee97088654cbc563bd23d10a7513622', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.325 INFO  [main] [Slf4jLogger] : CREATE SEQUENCE verification_token_id_seq START WITH 100000
2021-01-11 16:00:09.326 INFO  [main] [Slf4jLogger] : CREATE TABLE verification_token
(
    id               BIGINT DEFAULT nextval('verification_token_id_seq') PRIMARY KEY,
    uuid             VARCHAR        NOT NULL,
    user_id          BIGINT         NOT NULL,
    expiry_date      TIMESTAMP      NOT NULL,
    CONSTRAINT verification_token_user_id FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)
2021-01-11 16:00:09.327 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_user_id_idx ON verification_token (user_id)
2021-01-11 16:00:09.328 INFO  [main] [Slf4jLogger] : CREATE UNIQUE INDEX verification_token_unique_uuid_idx ON verification_token (uuid)
2021-01-11 16:00:09.329 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.329 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/8_init_schema_token.sql::8::Bolshakov ran successfully in 4ms
2021-01-11 16:00:09.330 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('8', 'Bolshakov', 'classpath:db/changelog/changesets/8_init_schema_token.sql', NOW(), 8, '8:d9d2918520e72bf69cac4428c7398fac', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.330 INFO  [main] [Slf4jLogger] : ALTER TABLE users ADD COLUMN enabled BOOLEAN DEFAULT true
2021-01-11 16:00:09.334 INFO  [main] [Slf4jLogger] : Custom SQL executed
2021-01-11 16:00:09.334 INFO  [main] [Slf4jLogger] : ChangeSet classpath:db/changelog/changesets/9_add_column_to_users.sql::9::Bolshakov ran successfully in 4ms
2021-01-11 16:00:09.335 INFO  [main] [Slf4jLogger] : INSERT INTO PUBLIC.DATABASECHANGELOG (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ('9', 'Bolshakov', 'classpath:db/changelog/changesets/9_add_column_to_users.sql', NOW(), 9, '8:2a7ac989d47bd8915109dafcb3cbb214', 'sql', '', 'EXECUTED', NULL, NULL, '3.8.9', '0370009264')
2021-01-11 16:00:09.336 INFO  [main] [Slf4jLogger] : Successfully released change log lock
2021-01-11 16:00:09.371 INFO  [main] [ExecutorConfigurationSupport] : Initializing ExecutorService 'applicationTaskExecutor'
2021-01-11 16:00:09.435 INFO  [task-1] [LogHelper] : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-01-11 16:00:09.481 INFO  [task-1] [Version] : HHH000412: Hibernate ORM core version 5.4.21.Final
2021-01-11 16:00:09.561 INFO  [task-1] [JavaReflectionManager] : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2021-01-11 16:00:09.594 WARN  [main] [JpaBaseConfiguration$JpaWebConfiguration] : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-01-11 16:00:09.639 INFO  [task-1] [Dialect] : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2021-01-11 16:00:10.071 INFO  [main] [DefaultSecurityFilterChain] : Creating filter chain: any request, [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1b32aaca, org.springframework.security.web.context.SecurityContextPersistenceFilter@4f7b4953, org.springframework.security.web.header.HeaderWriterFilter@27e25c2f, org.springframework.security.web.authentication.logout.LogoutFilter@5453b15d, ru.bolshakov.internship.dishes_rating.security.JwtTokenFilter@2154652c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@77a27356, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@46875fae, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7b5afde5, org.springframework.security.web.session.SessionManagementFilter@63a833c5, org.springframework.security.web.access.ExceptionTranslationFilter@2b1f0667, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@5b0fc8c2]
2021-01-11 16:00:10.198 INFO  [task-1] [JtaPlatformInitiator] : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-01-11 16:00:10.205 INFO  [task-1] [AbstractEntityManagerFactoryBean] : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-01-11 16:00:10.289 INFO  [main] [DirectJDKLog] : Starting ProtocolHandler ["http-nio-8080"]
2021-01-11 16:00:10.316 INFO  [main] [TomcatWebServer] : Tomcat started on port(s): 8080 (http) with context path ''
2021-01-11 16:00:10.684 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.687 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.687 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.768 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.768 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: integer, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.769 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.769 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: string, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.769 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.769 WARN  [main] [OperationImplicitParameterReader] : Unable to interpret the implicit parameter configuration with dataType: boolean, dataTypeClass: class java.lang.Void
2021-01-11 16:00:10.824 INFO  [main] [DeferredRepositoryInitializationListener] : Triggering deferred initialization of Spring Data repositories…
2021-01-11 16:00:11.115 INFO  [main] [DeferredRepositoryInitializationListener] : Spring Data repositories initialized!
2021-01-11 16:00:11.123 INFO  [main] [StartupInfoLogger] : Started DishesRatingApplication in 5.83 seconds (JVM running for 6.396)
2021-01-11 16:00:18.711 INFO  [http-nio-8080-exec-1] [DirectJDKLog] : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-01-11 16:00:18.711 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Initializing Servlet 'dispatcherServlet'
2021-01-11 16:00:18.716 INFO  [http-nio-8080-exec-1] [FrameworkServlet] : Completed initialization in 5 ms
